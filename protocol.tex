\section{Protocol}

\dots

\subsubsection{Temporal eligibility}

\Cref{CreatedBeforeEnd,CreatedAfterStart} requires a \emph{partially ordered 
  set}\footnote{%
  A relation \(\preceq\) which is reflexive, antisymmetric and transitive.
} of objects.
If some objects in the set relate to known points in time, then the partial 
order relates the data to the time of the event.
This allows us to \emph{verify the data temporally}.

One primitive that fulfils \cref{CreatedAfterStart,CreatedBeforeEnd} is a 
blockchain.
There are also other structures, e.g.\ a directed graph that 
converges~\cite{BlockchainFreeCryptocurrencies}.
(See \cref{PosetGraph}.)
For generality, we will use the terminology of 
\textcite{BlockchainFreeCryptocurrencies} and simply call this storage 
structure \iac{tposet}.

\begin{frame}
\begin{figure}
  \centering
  \input{fig/tposet.tex}
  \mode<article>{%
    \caption{%
      Alice submits proof \(p_A\) and Bob submits proof \(p_B\).
      We have \(t_s\prec p_A, p_B\prec t_e\), but \((p_A, p_B)\notin \prec\) 
      are incomparable.
    }\label{PosetGraph}
  }
\end{figure}

\mode<presentation>{%
  \only<1,2>{%
    \begin{idea}[Temporal eligibility]
      \begin{itemize}
        \item We need a partially ordered set (poset).

          \pause{}

        \item There is a mechanism that provides this property: a blockchain.
        \item There are also other structures, e.g.\ a directed 
          graph~\cite{BlockchainFreeCryptocurrencies}.
      \end{itemize}
    \end{idea}
  }
  \only<3>{%
    \begin{idea}[Created before end]
      \begin{itemize}
        \item Submit the proof to storage.
        \item The proof must've been created before it was included.
        \item If included before \(t_e\), then it was created before \(t_e\).
      \end{itemize}
    \end{idea}
  }
  \only<4>{%
    \begin{idea}[Created after start]
      \begin{itemize}
        \item Include an unpredictable value in the proof.
        \item This could be e.g.\ the hash of the \enquote{head} of the 
          \ac{tposet}, (\(t_s\) in the figure).
        \item This prevents creating proofs for future protests.
      \end{itemize}
    \end{idea}
  }
}
\end{frame}

\Cref{CreatedBeforeEnd} is straight-forward, Alice and Bob simply add their 
proofs to the \ac{tposet} \emph{in (time-wise) relation to the event}.
In \cref{PosetGraph}, if \(t_e\) is verifiably related to the end of the 
protest, then the relation will guarantee that \(p_A, p_B\) were created before 
the end of the protest.
Then we know that they cannot have been created after the event.

For \cref{CreatedAfterStart} Alice and Bob must include an unpredictable value 
in their proofs, e.g.\ \(t_s\) in \cref{PosetGraph}.
This means that if \(t_s\) is sufficiently close (time-wise) to the protest and 
has sufficiently high entropy, then Alice or Bob cannot create a proof and keep 
it for a future protest.

They can use an older value (pick one from the history of the \ac{tposet}) when 
they create their proofs.
This will only expand the interval of possible creation into the past.
This will not help their cause, as anyone will recognize that the proof could 
be created at any time in that interval, i.e.\ possibly before the protest.

\subsubsection{Spatial eligibility}

\Cref{SpatiallyRelated} binds the data spatially to the location, which allows 
us to \emph{verify the data spatially}.

If we include \iac{LP}, this will tie the proof to the physical location and, 
thus, solve \cref{SpatiallyRelated}.
The \ac{LP} is \enquote{witnessed} (signed) by other participants.
The \ac{LP} contains coarse coordinates of the location, which must be within 
the protest area to be valid.
This allows Bob the protester to move within the protest area to collect 
witnesses (signatures).
It also provides privacy since the location cannot be used to deanonymize Bob's 
proof --- e.g.\ to correlate the location in his proof with captured 
surveillance footage.

\mode<presentation>{%
\begin{frame}
  \begin{figure}
    \centering
    \begin{tikzpicture}
      \tikzset{grow'=right,level distance=5em}
      \Tree [.Proof
      [.{wsig} {\(x,y\)} {$t_s$} ]
      {\dots}
      [.{wsig} {\dots} ]
      ]
    \end{tikzpicture}
  \end{figure}

  \begin{idea}[Spatial eligibility]
    \begin{itemize}
      \item Include \iac{LP} which is \enquote{witnessed} (signed) by other 
        participants.
      \item We have a coarse location, just within the protest area.
      \item This allows protesters to move around to collect signatures.
      \item This provides privacy for the location, e.g.\ cannot map to 
        surveillance cameras.
    \end{itemize}
  \end{idea}
\end{frame}
}

\mode<none>{%
\begin{frame}
  \begin{idea}[Transitive trust]
    \begin{itemize}
      \item Trusted journalist Jane attends to report.
      \item She witnesses Alice's proof.

        \pause{}

      \item Alice witnesses Bob's proof.
      \item Alice's (secret key's) transportation is physically limited.
      \item Trust on Bob's proof is proportional to time from when Jane 
        witnessed Alice's proof.
    \end{itemize}
  \end{idea}
\end{frame}

\begin{frame}
  \begin{figure}
    \centering
    \begin{tikzpicture}
      \tikzset{grow'=right,level distance=5em}
      \Tree [.Proof
      [.{wsig} {\(x,y\)} {$t_s$} [.{\color{red}tsig} {$t_s'$} ] ]
      {\dots}
      [.{wsig} {\dots} ]
      ]
    \end{tikzpicture}
  \end{figure}

  \begin{remark}
    \begin{itemize}
      \item Secret key in hardware.
      \item Alice's witness signature must depend on Jane's.
      \item High-precision relation to time?
    \end{itemize}
  \end{remark}
\end{frame}
}

We will introduce a notion of transitivity for trust in these proofs.
The \emph{trusted} journalist Jane attends the protest to report on it.
She witnesses some participants' \acp{LP}, say Alice's \ac{LP} for example.
Now Alice's \ac{LP} can be trusted as correct at that point in time.
Alice's ability to travel is physically limited.
Thus a verifier can trust any \ac{LP} that Alice witnesses proportionally to 
the time that has passed since Jane witnessed Alice's \ac{LP}.
We can apply this argument recursively for any other participant's \ac{LP} that 
Alice has witnessed.
However, this requires some assumptions:
\begin{itemize}
  \item It is actually Alice's signing key must have physically limited travel.
    This can be assumed for signing keys that are embedded into hardware by 
    some trusted person.
  \item Alice's witness signature must depend on Jane's witness signature, to 
    prove that Alice signed after Jane.
\end{itemize}
\begin{remark}
  This probably requires high-precision timestamps, i.e.\ a trusted 
  time-stamping server must be available during the protest.
  Or the proofs must be submitted to the \ac{tposet} during the protest.
\end{remark}

\subsubsection{Linkability and designated protest}

\Cref{CountOnce} is required to prevent Sybil attacks, i.e.\ that one 
individual can provide two proofs of participation and thus be counted twice.
That situation should be detectable.
We can do this by ensuring that Alice cannot produce two valid proofs which
are unlinkable.
This can be done by including a signature made by a verified key.
(We will discuss the privacy aspects in \cref{Privacy}.)

\Cref{DesignatedEvent} focuses on the problem that there might be a counter 
protest at the same time and place, these would have the same spatial and 
temporal properties.
To distinguish them, we also need to prove for which of these events that a 
proof is designated.
This can be achieved by a unique identifier for a protest, e.g.\ the hash of 
its \enquote{manifesto}.

\begin{frame}
\begin{figure}
  \centering
  \mode<presentation>{%
    \only<1>{%
      \begin{tikzpicture}
        \tikzset{grow'=right,level distance=5em}
        \Tree [.Proof
        [.{wsig} {\(x,y\)} {$t_s$} [.{\color{red}osig} {$t_s'$} ]
        %[.tsig {$t_s''$} ]
        ]
        {\dots}
        [.{wsig} {\dots} ]
        ]
      \end{tikzpicture}
    }
  }
  \only<2>{%
    \begin{tikzpicture}
      \tikzset{grow'=right,level distance=5em}
      \Tree [.Proof
      [.{wsig} {\(x,y\)} {$t_s$} [.{osig} 
      [.{\mode<presentation>{\color{red}}\(id\)} manifesto ] {$t_s'$} ]
      %[.tsig {$t_s''$} ]
      ]
      {\dots}
      [.{wsig} {\dots} ]
      ]
    \end{tikzpicture}
  }
  \mode<article>{%
    \caption{%
      The proof depends on several witness signatures (wsig), each of which 
      depends on the owner's signature (osig), which depends on the \(id\) of the
      protest and the head of the \ac{tposet}.
      Whenever possible, the witness signature should include proof that the 
      witness themself has been witnessed by a trusted witness (tsig).
    }
  }
\end{figure}

\mode<presentation>{%
  \only<1>{%
    \begin{idea}[Count once]
      \begin{itemize}
        \item Any two proofs by the same individual are linkable.
        \item Includes signature made by a verified key.
      \end{itemize}
    \end{idea}
  }

  \only<2>{%
    \begin{idea}[Designated event]
      \begin{itemize}
        \item Include a protest-specific identifier.
        \item E.g.\ hash of the \enquote{manifesto}.
      \end{itemize}
    \end{idea}
  }
}
\end{frame}

\subsubsection{Individual and universal verifiability}

If the proofs are stored publicly, then an individual can check that their 
proof has been included (committed) there.
Thus \cref{IndividualVerif} is fulfilled.
Similarly for universal verifiability.
If the storage is public, then anyone can download all the proofs, verify their 
eligibility and count them.
Thus anyone can verify the result, which fulfils \cref{UniversalVerif}.

\mode<presentation>{%
\begin{frame}
  \begin{idea}[Individual verifiability]
    \begin{itemize}
      \item Proofs are stored (committed) publicly.
      \item Each participant can check that their proof is indeed included.
    \end{itemize}
  \end{idea}

  \pause{}

  \begin{idea}[Universal verifiability]
    \begin{itemize}
      \item Proofs are stored (committed) publicly.
      \item Anyone can download all proofs, verify eligibility and then count 
        them.
    \end{itemize}
  \end{idea}
\end{frame}
}


