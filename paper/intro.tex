\section{Introduction}%
\label{Introduction}

Elaborating on the scenario sketched in the abstract, Alice is an
activist who organizes a protest for some cause.
Eve is an autocrat who opposes Alice's cause.
Bob, Carol and many others participate in the protest for Alice's
cause and thus against Eve. To verify how many participated in Alice's
protest, a reliable crowd-counting mechanism is needed which is a 
problem that has not yet been entirely solved.

After many demonstrations the count by police and that by the organizers 
differ, for legitimate\footnote{%
  A difference is actually quite natural, as the counts have different goals.
  The organizers want to count everyone who ever participated.
  Police want to estimate the count at the peak of participation, due to crowd 
  control~\cite{2016DemonstrationsInSeoul}.
} or other reasons, in some instances the difference can be hundreds of thousands.
There are numerous examples where there is difficulty in establishing the actual 
number of participants, e.g.:\@ the demonstrations against the president in 
South Korea~\cite{2016DemonstrationsInSeoul}, Trump's inauguration 
attendance~\cite{HowWillWeKnowTrumpInauguralCrowdSize}, the 2017 Women's March 
in the US~\cite{2017WomensMarchesInUS}, the demonstrations against changing the 
constitution in Venezuela~\cite{AlJazeeraOnVenezuela2017} or for the 
independence of Catalonia~\cite{CataloniaDemonstrations}.
The methods for counting the crowds vary.
Most of the available methods lack precision, i.e.\ they have large error 
margins.
They can only give an estimate for a particular snapshot in time, e.g.\ at the 
peak of the event, not the cumulative participation count --- at least not 
without counting some people multiple times, which in turn increases the error 
of the estimation.
Finally, they also lack verifiability, i.e.\ everyone must trust the entity who
does the counting.
(We will discuss them in more detail in \cref{RelatedWork}.)

We can make one important observation about this problem that has not
been adequately addressed in the design of existing crowd-counting solutions: it is an adversarial setting.
Alice the activist has an incentive to increase the tallied number of 
participants, whereas Eve (and possibly other interests) have an incentive to 
decrease the tallied number of participants.
In this case we have two options:
either we trust Alice or Eve, or we must verify their claims.
Our main goal is to provide a scheme which prevents both Alice and Eve from 
cheating, i.e.\ we aim for verifiable claims.
To solve this problem, we need a verifiable participation count which is 
protected from Sybil attacks while still preserving the participants'
privacy to the extent possible given their physical presence at the protest.

\subsection{Combining properties of electronic voting with location proofs}

In general, protesting is very similar to petitions, which in turn are similar 
to voting: all three are many individuals expressing their opinion.
These opinions can be sensitive, e.g.\ cause for discrimination or persecution, 
hence we desire to have similar properties of verification and privacy for 
verifying a protest as there is for voting.

Voting has (generally) three desirable requirements for 
verifiability~\cite{VerifyingPrivacyPropertiesOfVotingProtocols}.
\begin{description}
  \item[Eligibility] anyone can verify that each vote cast is legitimate.
  \item[Universal verifiability] anyone can verify that the result is according 
    to the cast votes.
  \item[Individual verifiability] every voter can verify that their vote is 
    included in the result.
\end{description}
We translate the votes into \emph{proofs of participation}.
Universal and individual verifiability remain the same: anyone can verify the 
participation count by counting the proofs.
The eligibility requirement is slightly different:
for protests the eligibility requirement must include temporal and spatial 
eligibility, i.e.\ that each proof of participation satisfies some temporal and 
spatial relation to the protest.
In essence, the proof must bind the person to the time and location of the 
protest.
We will define these more formally in \cref{Verifiability}.

There are also three levels of 
privacy~\cite{VerifyingPrivacyPropertiesOfVotingProtocols}:
\begin{itemize}
  \item\label{VotePrivacy} Vote privacy: the voting does not reveal any 
    individual vote.
  \item\label{ReceiptFreeness} Receipt freeness: the voting system does not 
    provide any data that can be used as a proof of how the voter voted.
  \item\label{CoercionResistance} Coercion resistance: a voter cannot cooperate 
    with a coercer to prove the vote was cast in any particular way.
\end{itemize}
We note that we cannot actually improve the privacy of participating protesters during 
the protest: if Alice is caught during a protest or other
crowd-counting mechanisms based on photographic or video evidence are
used to identify Alice, there is nothing we
can do. In our proposed solution, however, we aim at verifiable
participation count that does not add any threats to the participants'
privacy. For instance, if there are counter-protests in the \emph{same location at the same 
  time}, Alice could even blend into another crowd and argue that she participated in 
a different protest than she actually did --- and the counts would still be 
correct afterwards.
However, even if there is only one protest and she is not caught in the act, 
then using our proposed mechanism should not incur any additional risk.
Thus we need at least participation-proof privacy but receipt freeness (see 
\cref{Privacy} for a detailed definition) is desired.
In essence, upon completing the protocol, Eve cannot link Alice to Alice's 
participation proof --- even if she were to compromise Alice's
devices.
%Sonja says: I'm confused: can we or can we not provide this?

\subsection{Contributions}

We propose a protocol which provides a way for protests to be securely verified.
Additionally, this verification system does not incur any additional risk to 
protesters' privacy than participating in the physical protest itself.

In contrast to the traditional assumption of honest verifiers in
distance-bounding algorithms, we propose a way to turn the Schnorr
protocol into a distance-bounding protocol that allows for a malicious
verifier. In addition, this allows us to form distance-bounding
anonymous credentials.

\subsection{Limitations and Assumptions}

We can achieve privacy, but not receipt freeness.
This means that there is a way for Eve to efficiently verify that Alice has 
participated.
However, this requires that Eve gets a copy of Alice's secret key so that she 
can simply re-do the (deterministic) computations on the same inputs --- the 
probability of collisions is negligible.

%\dots

Some of our assumptions (see Section \ref{assumptions} for more
detailed descriptions) are not yet
realized. Not all (or even many) protesters, especially in countries
with oppressive regimes, currently possess smartphones. Digital
certificates signed by a central authority are not yet widely
available and if we rely on government-issued credentials, we cannot prevent the government 
from performing Sybil attacks --- since it can issue arbitrarily many 
\enquote{valid} credentials. In this case we cannot verify any pro-government protests where Eve's authoritarian regime wants to organize a pro-regime protest to 
demonstrate its \enquote{wide 
  support}~\cite[e.g.][]{AlJazeeraOnVenezuela2017,VenezuelanStateWorkersCalledToParticipate}.
Distance bounding on phones is currently not feasible within a
meaningful range of distance for our scenario. 

The assumptions might
become sufficiently realistic in the near future, though, with
smartphone penetration on the rise, increased digitalization and government-issued credentials
available in some countries already now (e.g., Estonia, Germany), and
distance-bounding chips~\footnote{ https://www.3db-access.com } currently available with a range of 200 m that
might not unrealistically be integrated in phones or smartcards in the
future. 

\subsection{Roadmap}
The rest of the paper is organized as follows. First, we define the
system model for verifiable privacy-preserving crowd counting.  We then
present the desired security properties for such a system and subsequently discuss related
work in terms of these properties. We give the relevant background on
the building blocks of our solution and then describe our proposal for
distance-bounding anonymous credentials that copes with a malicious
(impersonating) verifier. We then present the protocol constructed
from the building blocks, its security and privacy analysis, and
finally our conclusions. 