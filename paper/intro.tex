\section{Introduction}%
\label{Introduction}

\paragraph*{Contributions}

We make three contributions.
First, we provide a version of the Schnorr protocol that is \ac{DBMF}, 
\ac{DBTF}, \ac{DBDH} and \ac{DBDF} resistant in the DFKO 
model~\cite{DB-DFKO,FormalTerroristFraud,TREAD}.
This version is based on the assumption that we can transmit all bits at once, 
not bit-by-bit as normally required for \ac{DB}.
This assumption is reasonable by the results of \textcite{UWBPR}.

Second, for the assumption about sending all bits at once to hold, 
\textcite{UWBPR} requires that two devices shared a symmetric key~\(k\).
Our second contribution is \iac{PKI} and \ac{AKE} scheme for any device in 
the \ac{PKI} to convince a verifier that this is the case.
This replaces everyone having the same static key~\(k\) with everyone having a 
unique key which is signed by \iac{CA} of the \ac{PKI}, which allows for 
revocation.
The solution relies on our first contribution.

Our last contribution is another version of the protocol, one which uses 
bit-by-bit transmissions as traditionally done with \ac{DB} protocols.
We achieve all properties except \ac{DBTF} resistance.

The first (and second) contribution enables us to do distance-bounding 
privacy-preserving attribute-based credentials based on discrete logarithms, 
\eg \cite{Camenisch-phdthesis} and \cite{CLsignatures}.
To our knowledge, no other distance-bounding protocol achieves this.
The third contribution (bit-by-bit version) also enables us to do the same, 
just without \ac{DBTF} resistance.

\paragraph*{Outline}

The paper is organized as follows.
\Cref{Preliminaries} introduces the preliminaries of \ac{ZKPK} and \ac{DB}.
\Cref{DB-Schnorr} introduces the first version, where we assume that we can 
send all bits at the same time.
\Cref{DB-Schnorr-PKI} introduces the \ac{PKI} and \ac{AKE} to use the first 
version of the protocol in practice.
\Cref{DB-Schnorr-nbit} describes the bit-by-bit version of the protocol.
\Cref{formal-verification} describes our effort to formally verify the protocol 
using Tamarin.
Finally, we conclude with discussion and conclusions in 
\cref{Discussion,Conclusion}.
