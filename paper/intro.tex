\section{Introduction}%
\label{Introduction}

\paragraph*{Contributions}

We make three contributions.
First, we provide a version of the Schnorr protocol that is \ac{DBMF}, 
\ac{DBTF}, \ac{DBDH} and \ac{DBDF} resistant in the DFKO 
model~\cite{DB-DFKO,FormalTerroristFraud,TREAD}.
This version is based on the assumption that we can transmit all bits at once, 
not bit-by-bit as normally required for \ac{DB}.
This assumption is reasonable by the results of \textcite{UWBPR}.

Second, for the assumption about sending all bits at once to hold, 
\textcite{UWBPR} requires that two devices shared a symmetric key~\(k\).
Our second contribution is \iac{PKI} and \ac{AKE} scheme for any device in 
the \ac{PKI} to convince a verifier that this is the case.
The solution relies on our first contribution.

Our last contribution is another version of the protocol, one which uses 
bit-by-bit transmissions as traditionally done with \ac{DB} protocols.
We achieve all properties except \ac{DBTF} resistance.

The first (and second) contribution enables us to do \ac{DB} \ac{ABC}.
The third enables us also to do \ac{DB} \ac{ABC}, just without \ac{DBTF} 
resistance.

Our main contribution is an adaptation of the Schnorr protocol~\cite{Schnorr} 
for \ac{DB}, but which is different from that of \textcite{DistanceBounding} or 
\textcite{Bussard-Bagga} (DBPK-Log).
Our adaptation fulfills all the requirements for modern \ac{DB} protocols, 
including \ac{DBDH} (which was an attack against the original protocol of 
Brands and Chaum) and \ac{DBTF}.
More importantly, it is public-key\footnote{%
  The majority of published works are in the shared-key setting.
  However, both the protocol by \textcite{DistanceBounding} and that of 
  \textcite{Bussard-Bagga} are public key.
}, handles malicious impersonating verifiers.
Since it is based on the Schnorr protocol, it provides a distance-bounded 
\ac{PK} for discrete logarithms.
That allows us to replace the plain Schnorr protocol in \acp{ZKPK} with our 
distance-bounding version and thus make general privacy-preserving, 
attribute-based credential systems distance bounding.

\paragraph*{Outline}

The paper is organized as follows.
\Cref{system-model}, we describe our system model and summarize the desired 
properties 
We then discuss related work in terms of these properties in 
\cref{related-work}, and in \cref{building-blocks}, we give 
the relevant background on the building blocks of our solution.

\Cref{DB-Schnorr-UWB}, we present a new \ac{DB} version of the Schnorr protocol, 
different from that originally proposed by \textcite{DistanceBounding}.
We provide a proof of its security and formally verify it using 
Tamarin~\cite{TamarinDB}.

We analyze its security in \cref{SecurityAnalysis} and estimate its performance 
in \cref{PerformanceAnalysis}.

Finally, we discuss our assumptions and results in \cref{Discussion} and give 
our conclusions in \cref{Conclusion}.
