\section{Introduction}%
\label{Introduction}

\emph{Context.} Consider the following illustrative scenario.
Alice is an activist that organizes a protest in some location(s) against the 
current regime leader Grace.
On the one hand, Alice wants to estimate the number of participants to prove a certain support for her cause.
On the other hand, Grace is an autocrat who opposes Alice's cause.
Bob, Carol and many others participate in the protest for Alice's cause against Grace.
However, they might only be willing to do so in a manner that does not leave any digital traces because of the fear of retribution against them from Grace's regime. 
To realize this objective a reliable yet privacy-preserving crowd-counting mechanism is needed, which to the best of our knowledge is a problem that has not yet been entirely solved.

Historically, there are many examples of protests in which the count estimated by police and that by the organizers 
differ significantly, sometimes in the order of hundreds of thousands.
The difference is actually quite natural as both parties have different objectives.
More precisely, the organizers want to count everyone who participated while the police want to estimate the count at the peak of participation, due to crowd control~\cite{2016DemonstrationsInSeoul}.
Among the numerous recent examples in which it is difficult to establish the actual number of participants, we can cite the demonstrations against the president in South Korea~\cite{2016DemonstrationsInSeoul}, Trump's inauguration attendance~\cite{HowWillWeKnowTrumpInauguralCrowdSize}, the 2017 Women's March in the US~\cite{2017WomensMarchesInUS}, the demonstrations against the change of constitution in Venezuela~\cite{AlJazeeraOnVenezuela2017} or for the independence of Catalonia~\cite{CataloniaDemonstrations}.

Existing methods for crowd-counting vary significantly in terms of approaches (we will review them in details in \cref{RelatedWork}).
However, most of them lack precision (\ie they have large error margins) and they can only give an estimate for a particular snapshot in time (\eg at the peak of the event). 
In particular, the existing methods cannot reliably estimate the cumulative participation count --- at least not without counting some persons multiple times, which in turn increases the error of the estimation.
In addition, they also lack verifiability. 
%as everyone has to trust the entity responsible for performing the counting.
%Sonja says: I commented this out as it doesn't apply to all. Sometimes you have to trust the data but can count yourself (pictures) or can even take pictures yourself but that's not really verifiability either.

Finally, one important observation about crowd-counting that has not been adequately addressed in the design of current crowd-counting solutions is that it is actually an adversarial setting. 
Indeed, going back to our example, Alice the activist has an incentive to increase the tallied number of participants, whereas Grace (and possibly other entities) have an incentive to decrease it.
In this case, we are left with two options: either we trust Alice or Grace (or 
another third party), or we have to be able to verify their claims ourselves.
In this paper, our main objective is to provide a scheme preventing both Alice and Grace from cheating (\ie their claim should be verifiable).
To solve this issue, we need a verifiable participation count that can resist Sybil attacks while still preserving the participants'
privacy to the extent possible given their physical presence at the protest. 
More precisely, our solution will not be able to prevent an observer (physically present or looking at photos or videos) from recognizing a particular individual at a protest. 
Nonetheless, we can ensure that none of the digital traces generated by a participant in our scheme can be associated with their identity and that their actions are also unlinkable.
%Sonja says: what actions do we refer to here?

%Seb: to do complete the contributions
\emph{Contributions.} In this paper, our main contribution is to propose \PRIVO, a privacy-preserving scheme providing a way to securely estimate crowd count in protests.
Additionally, this verification system does not incur any additional risk to protesters' privacy beyond the ones related to physically participating in the protest in the first place.

Our second contribution is an adaptation of the Schnorr protocol~\cite{Schnorr} 
for \ac{DB}, but which is different from that of \textcite{DistanceBounding}.
Our adaptation fulfils all the requirements for modern \ac{DB} protocols, 
including \ac{DBDH} (which was an attach against Brands-Chaum).
More importantly, it is public key (\ie handles malicious, impersonating 
verifiers), fulfils \ac{DBTF} and provides a \ac{PK} for discrete logarithms.
The latter allows us to replace the use of the plain Schnorr protocol in the 
\ac{ZKPK} used in anonymous credentials and thus we are, to the best of our 
knowledge, the first to provide \ac{DB} anonymous credentials.

\emph{Limitations and assumptions.} Some of the assumptions that are required 
for implementing our proposition are not yet realized (see \cref{assumptions} 
for more detailed descriptions). In particular, not all (or even many) 
protesters, especially in countries with oppressive regimes, currently possess 
smartphones.
In addition, digital certificates signed by a central authority are not yet widely available and if we rely on government-issued credentials, we cannot prevent the government from performing Sybil attacks --- since it can issue arbitrarily many \emph{valid} credentials. 
%Seb: maybe to prevent the above issue, we could require the individual to generate his secret key and only use the authority to obtain a certification on his public key (in the spirit of blind signature)
In this case, it does not make sense to verify any pro-government protests in 
which Grace's authoritarian regime wants to organize a pro-regime protest to 
demonstrate its wide support, 
\eg~\cite{AlJazeeraOnVenezuela2017,VenezuelanStateWorkersCalledToParticipate}.
Finally, achieving distance-bounding protocols on smartphones is currently not 
feasible within a meaningful range of distance needed for our scenario.
They lack the required hardware to do the distance bounding fast enough.

However, we believe that some assumptions might become sufficiently realistic in 
the near future, due to the smartphone penetration being on the rise and the 
increased digitalization and government-issued credentials available in some 
countries already now (\eg Estonia, Germany and Sweden).
In addition, the distance-bounding 
chips\footnote{\url{https://www.3db-access.com}} currently available can already 
enable proofs of proximity for any range of up to 200 meters.
One of the short-term objectives is to be able to integrate them in phones or smartcards in the near-future, and even phones with off-the-shelf hardware running in RFID-emulation mode have shown promising results~\cite{DBonSmartphones}.

\PRIVO achieves privacy, but not receipt freeness.
This means that there is a way for Grace to efficiently verify that Alice has 
participated.
However, this requires Grace to be able to get a copy of Alice's secret key so that she can simply re-do the (deterministic) computations on the same inputs (the probability of collisions being negligible).

%Seb: to do, update the outline
\emph{Outline.} The paper is organized as follows. First, we define and 
formalize the notion of protest and discuss its relationship with electronic 
voting (\cref{SystemModel}).  We then present the desired security properties 
for such a system (\cref{Properties}) and subsequently discuss related work in 
terms of these properties (\cref{RelatedWork}). We give the relevant background 
on the building blocks of our solution, including our proposal for 
distance-bounding anonymous credentials that cope with a malicious 
(impersonating) verifier (\cref{BuildingBlocks}). \PRIVO, the protocol 
constructed from the building blocks, is presented next (\cref{Protocol}) and we 
analyze its security and privacy (\cref{SecurityAnalysis}) as well as 
performance and implementation issues (\cref{PerformanceAnalysis}). We conclude 
with a discussion. 
