\section{Introduction}%
\label{Introduction}

\emph{Context.} 
Consider the following illustrative scenario.
Alice is an activist that organizes a protest in some location(s) against the current government, represented by Grace.
On the one hand, Alice wants to estimate the number of participants to prove a certain support for her cause.
On the other hand, Grace is an autocratic regime leader who opposes Alice's cause.
Bob, Carol and many others participate in the protest for Alice's cause against Grace.
However, they might only be willing to do so in a manner that does not leave any digital traces because of the fear of retribution against them from Grace's regime. 
To realize this objective, a reliable yet privacy-preserving crowd-counting mechanism is needed, which to the best of our knowledge is a problem that has not yet been entirely solved as of today.

Historically, there are many examples of protests in which the count estimated by police and that by the organizers differ significantly, sometimes in the order of hundreds of thousands.
Even without foul play, the difference is quite natural as both parties have different objectives and metrics.
More precisely, the organizers want to count everyone who participated while the police want to estimate the count at the peak of participation, due to crowd control~\cite{2016DemonstrationsInSeoul}.
Among the numerous recent examples in which it is difficult to establish the actual number of participants, there are the demonstrations against the president in South Korea~\cite{2016DemonstrationsInSeoul}, Trump's inauguration attendance~\cite{HowWillWeKnowTrumpInauguralCrowdSize}, the 2017 Women's March in the US~\cite{2017WomensMarchesInUS}, the demonstrations against the change of constitution in Venezuela~\cite{AlJazeeraOnVenezuela2017} or for the independence of Catalonia~\cite{CataloniaDemonstrations}.

Existing methods for crowd-counting vary significantly in terms of approaches (we will review them in detail in \cref{related-work}).
However, most of them lack precision (\ie they have large error margins) and they can only give an estimate for a particular snapshot in time (\eg at the peak of the event). 
In particular, the existing methods cannot reliably estimate the cumulative participation count --- at least not without counting some persons multiple times, which in turn increases the error of the estimation.
In addition, they lack verifiability in the sense that one has to trust the third party responsible for implementing the counting method. 

Finally, one important observation about crowd-counting that has not been adequately addressed in the design of current crowd-counting solutions is that it actually is an adversarial setting. 
Indeed, going back to our example, Alice the activist has an incentive to increase the tallied number of participants, whereas Grace (and possibly other entities) have an incentive to decrease it.
In this case, we are left with two options: either we trust Alice or Grace (or another third party), or we have to be able to verify their claims ourselves.
In this paper, our main objective is to provide a scheme preventing both Alice and Grace from cheating (\ie their claim should be verifiable).
To solve this issue, we need a verifiable participation count that can resist Sybil attacks while still preserving the participants' privacy to the extent possible given their physical presence at the protest. 
More precisely, our solution will not be able to prevent an observer (physically present or looking at photos or videos) from recognizing a particular individual at a protest. 
Nonetheless, we can ensure that none of the digital traces generated by a participant due to our scheme can be associated with 
their identity and that any witnessing is also unlinkable.

\emph{Contributions.} In this paper, our first main contribution is to propose \PRIVO, a privacy-preserving scheme providing a way to securely estimate crowd count in protests.
\sonja{commented out for repetition:This verification system does not incur any additional risk to protesters' privacy beyond the ones related to physically participating in the protest in the first place.}

Our second contribution is an adaptation of the Schnorr protocol~\cite{Schnorr} 
for \ac{DB}, but which is different from that of \textcite{DistanceBounding}.
Our adaptation fulfills all the requirements for modern \ac{DB} protocols, including \ac{DBDH} (which was an attack against Brands-Chaum).
More importantly, it is public-key, handles malicious impersonating verifiers, fulfills \ac{DBTF} and other types of resistance (see \cref{distance-bounding}), and provides a \ac{PK} for discrete logarithms.
The latter allows us to replace the use of the plain Schnorr protocol in the \ac{ZKPK} used in anonymous credentials.
\seb{once again I think it is too strong to say that are the first to provide distance-bounding anonymous credentials as a a distance-bounding anonymous protocol can already be considered an anonymous credential in the sense that it allows to authenticate anonymously in addition of providing proximity testing
%and thus we are, to the best of our knowledge, the first to provide \ac{DB} anonymous credentials.
}
\emph{Outline.} 
The paper is organized as follows.
First, in \cref{system-model}, we define and formalize the notion of protest 
and define the desired verifiability properties.
We also present our system and adversary model together with desired privacy 
properties.
Next, in \cref{related-work}, we discuss related work in terms of these 
properties.
In \cref{building-blocks}, we give the relevant background on the building 
blocks of our solution.
In \cref{DB-anon-cred}, we present a new \ac{DB} version of the Schnorr 
protocol, different from that originally proposed by 
\textcite{DistanceBounding}.
We provide a proof of its security (all desired \ac{DB} properties) 
\daniel{Check that this is true before publication.} and formally verify it 
using Tamarin~\cite{TamarinDB}.
This version of the Schnorr protocol can then be used to do general \ac{DB} 
anonymous credentials.
In \cref{Protocol}, we present \PRIVO, the protocol constructed from these 
building blocks.
This is followed by an analysis of its security and privacy 
(\cref{SecurityAnalysis}).
Finally, we conclude with a discussion in \cref{Discussion} and future work in 
\cref{Conclusion}.
