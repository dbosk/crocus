\section{Desired security properties}%
\label{Properties}

%\subsection{An overview of the adversary}

We have three \emph{malicious} adversaries: Alice, Eve and Rusuk.
Alice the activist (and all the protesters) try to increase the count.
Eve the totalitarian dictator tries to decrease the count.
Additionally, Eve tries to deanonymize the participants to arrest them or 
\emph{convince} them to change their minds.
Finally, we have Rusuk who is represents another nation state.
Rusuk has some interest in affecting the state of Eve's regime, for Rusuk's own 
gain, thus supporting either Eve or Alice as he see fits.
Rusuk will thus also try to either increase or decrease the count.
We will now formally define some security properties specifying the 
computational effort needed by the adversaries to succeed.
We categorize the desired properties into verifiability and privacy.

\subsection{Verifiability}%
\label{Verifiability}

We desire three verifiability requirements:

\begin{requirements}[V]
  \item\label{EligibilityVerif} Eligibility: anyone can verify that each 
    participation proof provides temporal and spatial eligibility and that it 
    has not been counted before.
    \begin{requirements}
    \item Temporal egligibility:%
      \label{CreatedAfterStart} prove that the data was created after the start of 
      the event;%
      \label{CreatedBeforeEnd} prove that the data was created before the end of 
      the event.
    \item Spatial eligibility:%
      \label{SpatiallyRelated} prove that the data is spatially related to the 
      physical location of the event.
    \item One-proof-per-person:%
      \label{CountOnce} prove that no individual can be counted more than once.
    \item Designated event:%
      \label{DesignatedEvent} prove that the data is designated for the event.
    \end{requirements}

  \item\label{UniversalVerif} Universal verifiability: anyone can verify that the 
    result is according to the submitted participation proofs.
  \item\label{IndividualVerif} Individual verifiability: every participant can 
    verify that their participation proof is included in the global count.
\end{requirements}
We will now discuss these in more detail.

\subsubsection{Temporal eligibility}

\begin{definition}[Forging temporal eligibility]
  \dots
\end{definition}

\subsubsection{Spatial eligibility}

\begin{definition}[Forging spatial eligibility]
  \dots
\end{definition}

\subsubsection{Linkability and designated protest}

\dots

\subsubsection{Individual and universal verifiability}

\dots

\subsection{Privacy}%
\label{Privacy}

We also need privacy in addition to the verification requirements.
As we indirectly pointed out earlier, we focus on the privacy provided to Alice 
and Bob by the data.
So as long as Alice and Bob can conceal their identities at the demonstration 
and escape without arrest, their support is recorded in the data while their 
privacy is not violated.
(Following this line of thinking, it can actually be beneficial for the privacy 
of the demonstrators to mix with the participants of any counter-demonstrations 
--- since the counts will still be correct.)

In voting, we have the following requirements:
\begin{requirements}[P]
\item\label{VotePrivacy} Vote privacy: the voting does not reveal any 
  individual vote.
\item\label{ReceiptFreeness} Receipt freeness: the voting system does not 
  provide any data that can be used as a proof of how the voter voted.
\item\label{CoercionResistance} Coercion resistance: a voter cannot cooperate 
  with a coercer to prove the vote was cast in any particular way.
\end{requirements}
\Citet{VerifyingPrivacyPropertiesOfVotingProtocols} showed that 
\cref{CoercionResistance} implies \cref{ReceiptFreeness}, which in turn implies
\cref{VotePrivacy}.
\Cref{CoercionResistance} is probably not possible to achieve for protests:
e.g.\ Eve can simply physically bring Alice to a protest against her will.
This leaves us with \cref{ReceiptFreeness,VotePrivacy}.

\subsubsection{Participation-proof privacy}

\begin{definition}[Proof indistinguishability]
  Adversary chooses two messages \(m_0, m_1\) and gives them to the challenger.
  Challenger uniformly randomly selects \(b\rgets \bin\) and runs \(c_b \gets 
    PRF_k(m_0), c_{1-b} \gets PRF_k(m_1)\).
  The challenger gives \(c_0, c_1\) to adversary.
  If the adversary outputs \(b' = b\) she wins.
  (The property should be similar to key privacy~\cite{KeyPrivacy}.)
\end{definition}

\subsubsection{Receipt freeness}

\begin{definition}[Receipt freeness/deniability]
  Adversary gets oracle access to the user?
  User provides a witness?
\end{definition}

