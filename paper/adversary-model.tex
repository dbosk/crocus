\subsection{Adversary model}%
\label{formal-adversary-model}

We now provide a concretely defined system and adversary model.
We give three definitions, each defines an adversary with increasingly stronger 
capabilities (\ie more auxiliary information).

There are three players: the protester (with identity) \(P\), a witness (with 
identity) \(W\) and the time-stamping storage \(S\) (that will contain the set 
of all proof shares, \(\pshs\)).
The protester \(P\) and the witness \(W\) communicate some protocol data,
\(d_{P,W}(\cid, P)\), and records when the communication occurred \(t_{P,W}\).
The protester \(P\) communicates with \(S\), in which \(S\) only learns some 
function of the protocol data exchanged with the witness, \(f(d_{P,W}(\cid, 
  P))\) for some function \(f\), and the time of the communication 
(\(t_{P,S}\)).
This is illustrated in \cref{fig:base-adversary}.

\begin{figure}
  \centering
  \includegraphics{base-adversary.tikz}
  \caption{\label{fig:base-adversary}%
    An overview of the base adversary model.
    The protester with real identity \(P\) and witness with real identity \(W\) 
    communicate.
    They exchange protocol data, \(d_{P,W}(\cid, P)\), and record the time it 
    happened, \(t_{P,W}\).
    The protester submits \(f(d_{P,W}(\cid, P))\), for some function \(f\), to 
    the storage \(S\), who records the time it happened, \(t_{P,S}\).
    Both the witness \(W\) and storage \(S\) are controlled by the adversary 
    \(A\) (from \cref{base-adversary}).
  }
\end{figure}

\begin{adversaries}
\item\label{base-adversary}
  \emph{Base adversary}:
  The adversary maliciously controls \(W\).
  The adversary honest-but-curiously controls \(S\).
  The adversary only learns the protocol data --- \ie what is sent over the 
  channel, no auxiliary data (such as who sent it).

\item\label{deanonymizing-witness-adversary}
  \emph{Deanonymizing-witness adversary}:
  The situation is the same as in \cref{base-adversary}, but now the witness 
  \(W\) learns the protester \(P\)'s identity from an auxiliary channel.
  %(\(P\) will also learn \(W\)'s identity.)
  However, \(S\) still learns only the protocol data, no auxiliary data.

\item\label{deanonymizing-adversary}
  \emph{Fully deanonymizing adversary}:
  Everything is the same as in \cref{deanonymizing-witness-adversary}, except 
  that now \(S\) also learns \(P\)'s identity from an auxiliary channel.
\end{adversaries}

The base adversary (\cref{base-adversary}) represents an adversary that has no 
access to auxiliary information, \eg inferences that can be done from the 
communication layer, which means that it has only the protocol data at its 
disposal.

We find \cref{base-adversary} suitable when the protester and witness both move 
in a crowd and there is no way for the witness to decide exactly with whom he 
or she communicates with.
However, in some situations this might not be the case: \Eg if the crowd is not 
dense the witness will likely see the face of the protester.
If the witness is controlled by the adversary, then it is likely that the 
witness can capture a picture of the face, which can be turned into an identity 
through face recognition.
There are various such scenarios leading to the adversary learning the 
protester's identity, we capture this as 
\cref{deanonymizing-witness-adversary}.

As to \(S\), \cref{base-adversary} corresponds to an adversary who cannot 
control the channel between \(P\) and \(S\), \eg when \(P\) uses 
Tor~\cite{Tor}.
The adversary cannot control \(S\) but can learn what \(S\) learns as soon as 
\(S\) learns it, \eg when \(S\) is operated outside the adversary's 
jurisdiction.

However, given a strong enough adversary, such anonymous communication might 
not be possible; \eg if the adversary can do a time-correlation attack.
We capture such a strong adversary as \cref{deanonymizing-adversary}.

