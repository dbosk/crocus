\section{Discussion}%
\label{discussion}


\subsection{System model and physical assumptions}\label{assumptions}

Throughout this text, when we refer to a participant, say Alice, we actually 
mean an agent which can perform cryptographic operations and communicate with 
other local devices on Alice's behalf. We assume that every participant has a digital certificate signed by 
some logically centralized certificate authority.
\Eg that we can use the cryptographic keys of any national electronic identity 
system, identity card or passport.
We need this to prevent Sybil attacks~\cite{SybilAttack}.

In practical terms, participants witness each other's participation
using their smartphones (or similar devices) running the protocol described in
\cref{Protocol} and uploading their testimony (\ie proof shares) to a blockchain 
after the protest. During the protest the devices are computationally limited by 
their batteries and need local connectivity to each other but no connection to
any global network such as the Internet is necessary. Before and
after the protest, we assume that the devices have global connectivity, \ie 
Internet  connections, and are not computationally limited by any battery.

\include*{MANETs}

\subsection{Limitations from assumptions} 

Some of the assumptions that are required for implementing our
proposition are not yet realized, chiefly, use of smartphones, unique
identities, distance bounding on phones). 
In particular, not all (or even many) protesters, especially in countries with oppressive regimes, currently possess smartphones.
In addition, digital certificates signed by a central authority are not yet widely available and if we rely on government-issued credentials, we cannot prevent the government from performing Sybil attacks --- since it can issue arbitrarily many \emph{valid} credentials.
In this case, it does not make sense to verify any pro-government protests in which Grace's authoritarian regime wants to demonstrate its wide support, \eg~\cite{AlJazeeraOnVenezuela2017,VenezuelanStateWorkersCalledToParticipate}.
Finally, achieving distance-bounding protocols on smartphones is currently not feasible within a meaningful range of distance needed for our scenario.
Indeed, existing smartphones lack the required hardware to do the distance bounding fast enough.

However, we believe that some assumptions might become sufficiently
realistic in a near future, due to the smartphone penetration being on
the rise and the increased digitalization and government-issued
credentials available in some countries already now (\eg Estonia,
Germany and Sweden). The speed of adoption will depend on the architecture of these systems.
For instance, the system used in Sweden, BankID, is implemented in software and 
can thus be easily upgraded to include the anonymous credentials we need.
As for coverage of the population: more than \SI{95}{\%} of people in the ages 
21--50 uses BankID, it is \SI{88}{\%} for ages 51--60 and \SI{76}{\%} for ages 
61--70\footnote{%
  Official statistics, in Swedish:
  \url{https://www.bankid.com/assets/bankid/stats/2018/statistik-2018-04.pdf}.
}.

In addition, the distance-bounding chips\footnote{\url{https://www.3db-access.com}} currently available on the market can already enable proofs of proximity for any range of up to 200 meters.
One of the short-term objectives is to be able to integrate them in phones or smartcards in the near-future, and even phones with off-the-shelf hardware running in RFID-emulation mode have shown promising results~\cite{DBonSmartphones}.

% Currently, the only problem preventing wide deployment is the lacking hardware 
% in smartphones.
% However, due to the rapid development of \enquote{smart} solutions, we believe 
% this is only a matter of time.
% \Eg mobile payments and public transport tickets that can be used over \ac{NFC} 
% will eventually require \iac{DB} chip.
% Without \ac{DB} for these applications, the user must manually confirm on the 
% screen to prevent attacks.
% We believe that the drive for increased usability will replace this type of 
% confirmation by distance bounding.

% The deployment of the needed credentials should not be a problem either.
% There are already countries where national \ac{eID} systems are widely deployed.



\subsection{Blockchain efficiency}
One problem can arise in the case of no trusted witnesses.
If we set the threshold too high, we need to submit more proof shares than the 
blockchain can handle within a reasonable time.
As an example, consider a protest with 1\,000\,000 participants.
If we use trusted witnesses, each participant only needs to acquire one proof 
share from a trusted witness.
Thus there will be 1\,000\,000 proof shares submitted to the blockchain in 
total.
If we consider OmniLedger~\cite{OmniLedger}, it can do approximately 1500 
transactions per second.
This means it will take 11 minutes to process all the proof shares.
On the other hand, if we do not use trusted witnesses, but a threshold 
\(\theta\) of, say, \(\theta = 1000\), then it will take 7 days before all 
transactions are committed to the blockchain.


%assumptions about smartphones:
%(This means that we essentially provide a lower bound for the participation 
%count, since some participants might not have such a device.)
%Sonja says: is this still true? Given mafia fraud we can't guarantee
%that, right?
 
\subsection{Differences to e-voting}

In e-voting, receipt freeness means one cannot prove to a third party
how one voted. In the context of protests, receipts for mere
participation can imply one's political leanings, as even with a
counterprotest at the same location and time, side-channel information
can be used to decide which one a person participated in. Individual
verifiability and eligibility (especially one proof per person,
prevention of Sybil attacks) means a person can check whether her
input was counted, thus sufficing as a receipt in the case of
protests.  \PRIVO therefore achieves privacy but not receipt freeness.
This means that there is a way for Grace to efficiently verify that
Alice has participated if she is able to get a copy of Alice's secret
key. The very property that prevents Alice from cheating by creating
\(\pid, \pid'\), such that \(\pid \neq \pid'\), is the property that
allows Grace to verify Alice's participation proof.  Indeed, in this
case Grace can simply re-do the (deterministic) computations on the
same inputs (the probability of collisions being negligible).  If
Grace can perform computations using Alice's key, Grace can input the
\(\cid\) of interest and see if the resulting \(\pid\) is available on
the blockchain.  To mitigate this situation, Alice could delete her
key, in which case she cannot participate in any future protest.  As
implied by the last statement, there is the problem of renewing
credentials.  As with all identity cards, passports \etc, they have a
limited lifetime and must be renewed at regular intervals.  The rate
at which Alice is allowed to renew her credentials affects to what
extent she can perform Sybil attacks. Another facet concerning receipt
freeness is traffic analysis. If Grace can monitor all connections
within the country, which seems a reasonable assumption, she can
monitor Alice as she submits her proof to the blockchain. However, as
the miner collects many transactions, Alice should have plausible
deniability that she submitted one of the other transactions --- but
again not deniability/receipt freeness as Grace can verify if she
accesses Alice's device.

Counting votes is also more straighforward than counting protest
participation. Depending on the value of interest (peak participation,
total participation, individual sub-protests or counting participation
only once for the cause, etc.), different ways of counting are
possible and valid. Since anyone can read the data, one can verify the
results given the parameters of choice.

\subsection{Other actors}

Without verifiable binding to a location, even distance bounding does
not prevent collusions such as protesters meeting at a safe location
away from the official site. To address that, one can use trusted
infrastructure (for an example by media see~\cite{LeMondeProtestingSolution}) or people
such as journalists. Given the conflict of interest of potentially
state-provided infrastructure for political protests, we opt for the
trusted journalist, Jane, who reveals her identity after the protest
and thus can be used as a trusted witness. There can be any number of
Janes and, as with the different ways of counting, there does not need
to be an agreement on who is trusted as anyone can set the eligibility
criteria for their count.

Finally, Mallory represents another nation state and has some interest
in affecting the stability of Grace's regime, for Mallory's own gain,
thus supporting either Grace or Alice as she see fits.  Thus, the
objective of Mallory will also be to either increase or decrease the
count. Mallory cannot create keys valid in another nation
state. Unlike Alice, Mallory can create as many keys as she likes, but
she cannot create keys valid in another nation state. Mallory could
also have simply as her objective to cause a denial-of-service attack
on the architecture of \PRIVO.



