\subsection{Security requirements}%
\label{security-properties}

To go back to the scenario stated in the introduction, we have two potential 
adversaries: Alice and Grace.
Alice is a participant of the protest and thus she might be also interested in manipulating the system to increase the count (\eg she might have an incentive to do so as an activist).
In contrast, the aim of Grace, the government Alice protests against, is to not only decrease the count, but also to re-identify some of the participants in order to arrest them or forcefully convince them to change their minds.
In the following two subsections, we will define the desired security properties.

\subsubsection{Verifiability}%
\label{Verifiability}

We note that, in general terms, protesting is very similar to petitions, which in turn are similar to voting.
Indeed, all three situations correspond to cases in which many individuals express their opinion.
These opinions can be sensitive (\eg be a cause for discrimination or persecution), hence we desire to have similar properties of verification and privacy for verifying a protest as there are for voting.

Voting has (generally) three desirable requirements for verifiability~\cite{VerifyingPrivacyPropertiesOfVotingProtocols}.
\begin{description}
  \item[Eligibility:] anyone can verify that each cast vote is legitimate.
  \item[Universal verifiability:] anyone can verify that the result is according to the cast votes.
  \item[Individual verifiability:] each voter can verify that his vote is included in the result.
\end{description}
In our context, votes are translated into \emph{participation proofs}.
Universal and individual verifiability remain the same, in the sense that anyone can verify the participation count by counting the proofs.
The eligibility requirement is slightly different as for protests it must include temporal and spatial eligibility (\ie each participation proof satisfies some temporal and spatial relation to the protest).
In essence, the proof must bind the person to the time and location of the protest.

To define these properties more formally in the context of protest, we define three verifiability requirements, among which eligibility can be further broken up into four subproperties:
\begin{requirements}[V]
  \item\label{EligibilityVerif} \emph{Eligibility}: anyone can verify that each participation proof provides temporal and spatial eligibility and that only one participation proof is counted per individual.
    \begin{requirements}
    \item\label{TemporallyRelated} \emph{Temporal eligibility}: prove that the proof was created after the start of the protest and before the end of the protest.
    \item\label{SpatiallyRelated} \emph{Spatial eligibility}: prove that the proof is spatially related to the physical location or journey of the protest.
    \item\label{CountOnce} \emph{One-proof-per-person}: prove that no individual can be counted more than once for a particular protest.
    \item\label{DesignatedEvent} \emph{Designated event}: prove that the proof is associated to particular designated protest.
    \end{requirements}

  \item\label{UniversalVerif} \emph{Universal verifiability}: anyone can verify that the result obtained match the submitted participation proofs.

  \item\label{IndividualVerif} \emph{Individual verifiability}: each participant can verify that his participation proof is included in the global count.
\end{requirements}

\subsubsection{Privacy}%
\label{Privacy}

In addition to the verification requirements, we also need to define the privacy properties.
In voting protocols, there are mainly three levels of privacy~\cite{VerifyingPrivacyPropertiesOfVotingProtocols}:
\begin{description}
\item[Vote privacy:] the voting does not reveal any individual vote.
\item[Receipt freeness:] the voting system does not provide any data that can be used as a proof of how the voter voted.
\item[Coercion resistance:] a voter cannot cooperate with a coercer to prove the vote was cast in any particular way.
\end{description}

\Citet{VerifyingPrivacyPropertiesOfVotingProtocols} showed that coercion resistance implies receipt freeness, which in turn implies vote privacy.
Coercion resistance is not possible to achieve for protests.
For instance, someone could simply physically bring Alice to a protest against her will.

\sonja{discussion about applicable properties here, more sources and alternative properties}
\sonja{new}
Difference to e-voting:
physical presence means support for a cause if there is one protest. If there is a counterprotest, physical presence with that group means support for the counterprotest. In our system, it gets more ambiguous as the participants are counted if all of the following is true
\begin{enumerate*}
\item they participate in the protocol,
\item they use the protest identifier (cause) for which the count is done,
\item they meet the eligibility criteria, and
\item they receive enough proof shares,
\item that are uploaded to the ledger.
\end{enumerate*}
Thus one could participate in a protest and be counted even when physically 
present at a counter-protest if the two protests are co-located and the 
participant chooses the corresponding cause/identifier of the original protest.

Given that all conditions for being counted in a protest are met, individual verifiability implies a receipt, because being counted implies support for a cause. This also means that besides physical force, coercion can happen by forcing the participate to show a receipt. We thus have to decide between individual verifiability and the privacy properties for e-voting or define privacy properties suitable for the scenario. The ultimate privacy requirement is thus stronger here: in contrast to voting, where it is the content of the vote itself that needs to be unlinkable to the voter, here the fact of having cast a vote at all needs to be unlinkable.

The privacy properties we need in this context are
\begin{description}
  \item[involuntary participant unlinkability] unless the participant discloses 
    the receipt (by revealing her identity), there is no link between the 
    protest data on the ledger and the identity of the participant.

  \item[involuntary witness unlinkability] unless the witness discloses the 
    receipt (by revealing her identity), there is no link between the protest 
    data on the ledger and the identity of the witness.
\end{description}
\sonja{old}
In essence, receipt freeness means that upon completing the protocol, Grace cannot link Alice to Alice's participation proof --- even if she were to compromise Alice's device or Alice accepts to collaborate with Grace.
As we will see, if Grace gets Alice's device, she can re-do the computations on the same inputs.
Since, in our case, the algorithms are deterministic and collisions are negligible, she will produce the same output and can thus conclude that Alice is indeed the one she is looking for.
Thus, we cannot provide receipt freeness (see \cref{Conclusion} for further discussions on this issue).

As a consequence, this leaves us with with what would correspond to vote privacy.
In particular, we need unlinkability between Alice's long-term identity and Alice's participation proof.
Given a participation proof, Grace will not be able to tell if it belongs to Alice or Bob.
Furthermore, if Grace has managed to link one proof to Alice's, she should not be able to link another proof (\eg, from a different protest) as a consequence.
Hence, we can summarize the needed privacy properties as follows:
\begin{requirements}[P]
\item\label{ProofUnlink} \emph{Anonymity}: participants must be unlinkable to their proofs.
\item\label{ProtestUnlink} \emph{Unlinkability}: participants (or proofs issued by the same participant) must be unlinkable between different protests.
\end{requirements}

As a result of these properties, if there are two protests in parallel (\eg, one against Grace's regime and one in favor) Alice can always argue to be part of the protest in Grace's favor instead of any protest against Grace.
This is, in fact, is a slight increase in privacy over ordinary protests.

